---
title: "Project Proposal"
author: "Standard Deviants - Ava Exelbirt, Yura Heo, Claire Li"
format: pdf
execute: 
  warning: false
  message: false
editor: visual
---

```{r, echo = FALSE}
#| label: load-pkg-data
library(tidyverse)
library(tidymodels)
library(skimr)
library(patchwork)

sports <- read.csv("data/sports.csv")
```

## Introduction

In our research project, we aim to investigate and understand the factors influencing the revenue generated by collegiate sport, specifically basketball, in the school year 2019 to 2020, We will be utilizing a dataset sourced from Tidy Tuesday, which provides a comprehensive collection of observations related to collegiate sports, including information about the schools, classifications, sport types, and various quantitative variables describing the sport players and the schools' financial investment in sports programs in the dataset called "sports.csv". Our primary motivation for this research is to gain insights into the determinants of collegiate basketball revenue, which can be of significant interest to educational institutions and further local policy makers and sports enthusiasts. Understanding the factors that contribute to revenue generation in collegiate basketball sports can inform decision-making, investment strategies in sports, and future planning for universities and colleges involved in sports programs. 

Our primary research question is as follows: **In the school year 2019 to 2020, how can we predict the revenue in USD of the collegiate sports basketball using participation rate, school sector name, expenditure, gender, total count of students, and school classification name.**

Our hypothesis is as follows: **Expenditure, sector name, and gender will be the most influential predictors for the total revenue generated by the collegiate sports basketball in USD.**

We anticipate that expenditure will be a key predictor of total revenue of the sports basketball because schools often allocate significant financial resources to their sport programs, scholarships, and marketing. As these investments increase, the expectation is that they will have a direct impact on the overall revenue generated through different resources such as ticket sales. We also expect that the type of school (sector name) will be a strong predictor of revenue because different types of schools have varying levels of resources, alumni support, and participation rates in sports depending on school size and program. Gender is another predictor to consider because sports could be hugely dependent on the demographics of players. 

-   Collegiate Sports Dataset: <https://github.com/rfordatascience/tidytuesday/tree/master/data/2022/2022-03-29>

## Data description

The data set was taken from TidyTuesday and was originally scraped from Equity in Athletics Data Analysis (EADA), a sector of the US Department of Education. The data is available on an online database found on the (EADA) website[^1].

[^1]: <https://ope.ed.gov/athletics/#/datafile/list>

This data is submitted annually from colleges to the EADA. All co-educational postsecondary institutions that receive Title IV funding that have intercollegiate athletics programs are required by the Equity in Athletics Disclosure Act to submit this data[^2]. The original data files are also created immediately after the data collection for each school. These data are collected annually starting from 2003 to 2022, but for our specific data analysis we will only look at data taken from the school year of 2019 by cleaning the data to a new csv file which we will use for the rest of the projecr. The csv file from Tidy Tuesday contains thousands of observations from years 2015-2019, but we have adjusted the data file to only include year 2019 and will filter the data to only include basketball as a sport, as this is our population we are analyzing.

[^2]: <https://knightnewhousedata.org/about-the-data#:~:text=The%20data%20is%20available%20via,student%20aid%20programs>)

The dataset we will use from the data scraped on Tidy Tuesday include many observations regarding collegiate sports. These observations include variables such as the name of the city which a school is in, the state, the school name, the classification of the school (like whether it is NCAA Division I, II, or III), the sector name of the school (like 4 year accredited university), sport, and many quantitative variables regarding characteristics about the specific school and their collegiate spending. Most of the quantitative variables are split between men and women, having two different observations for the same variable. For example, there is total male population, total female population, participation rate of women, participation rate of men, participation rate for coed sports for men, participation rate for coed sports for women, revenue for men, revenue for women, expenditures for men, and expenditures for women. There are also observations for the total amount for each of these above variables which includes both men and women; for example, total expenditures for both men and women together. The observations are therefore both quantitative and categorical and measure characteristics of different school's spending, revenue, populations, locations, and sports.


## Initial exploratory data analysis

For data cleaning, we need to filter for observations that have `Basketball` as the sports and filter out missing values. we also need to filter out observations that have missing values of the predictor variables we need in the model. We need to create new variables by mutation to turn variables involving revenue and expenditure into the unit of millions, so that we can get larger coefficients for better modeling.

```{r, echo = FALSE}
basketball <- sports |>
  filter(sports == "Basketball") |>
  mutate(total_rev_mill = total_rev_menwomen / 1000000,
         total_exp_mill = total_exp_menwomen / 1000000)
```

**Distribution of the response variable: total revenue generated by college sports**
```{r, echo = FALSE, fig.width = 6, fig.height = 2}
basketball |>
  ggplot(aes(x = total_rev_mill)) +
  geom_histogram() +
  labs(title = "Distribution of Total Revenue (in million $)",
       x = "Total revenue (in million $)", y = "Count")

basketball |>
  skim(total_rev_mill) |>
  select(-skim_type, -skim_variable, -complete_rate,
         - numeric.hist) |> 
  print(width = Inf) 
```

The distribution is right-skewed, as most observations are at the lower end of the x axis with a number of outliers having very high values. The center is the median of 0.431111 million dollars due to the apparent skewness. Since the distribution is skewed, the IQR is used as a more reliable measure of spread which is Q3 - Q1 = 1.098081 - 0.19334 = 0.904741 million dollars. There are 57 missing values of total revenue.

**Distributions of total expenditure (potential quantitative predictor variable) and type of school (potential categorical predictor variable)**
```{r, echo = FALSE}
p_exp <- basketball |>
  ggplot(aes(x = total_exp_mill)) +
  geom_histogram() +
  labs(title = "Distribution of 
Total 
Expenditure 
(in million $)",
       x = "Total expenditure 
(in million $)", 
y = "Count")

p_type <- basketball |>
  group_by(sector_name) |>
  count() |>
  ggplot(aes(x = sector_name, y = n)) +
  geom_boxplot() +
  coord_flip() +
  labs(title = "Distribution of 
Types of School",
       x = "Types of school", y = "Count")

p_exp + p_type

t_exp <- basketball |>
  skim(total_exp_mill) |>
  select(-skim_type, -skim_variable, -complete_rate,
         - numeric.hist) |> 
  print(width = Inf) 

cat_statistics <- function(x) {
  nmiss <- sum(is.na(x))
  n     <- table(x)
  p     <- prop.table(n)
  OUT   <- cbind(n, p)
  nmiss <- c(nmiss, rep(NA, nrow(OUT)-1))
  OUT   <- cbind(OUT, nmiss)
  return(OUT)
}
cat_statistics(basketball$sector_name)

```
The distribution of total expenditure on college sports is right-skewed with most total expenditure values in the lower range, while a number of observations have very high values that make them outliers. Given the apparent skewness, the center is the median of 0.433728 million dollars. Since the distribution is skewed, the IQR is used as a more reliable measure of spread which is Q3 - Q1 = 1.100745 - 0.188125 = 0.91262 million dollars. There are 57 missing values of total revenue.

here are 5 types of school. Private for-profit, 2-year and private nonprofit, 2-year have low numbers of observations. Private nonprofit, 4-year or above, public, 2 year, and public, 4-year or above have comparably higher number of observations than the other two, with private nonprofit, 2-year having the highest number of observations. There is 1 missing value of type of school.

**The relationships between total revenue and each of the predictors**
```{r, echo = FALSE, fig.width = 6, fig.height = 2}
basketball_f <- basketball |>
  filter(!is.na(total_exp_mill),
         !is.na(total_rev_mill))

p_rev_exp <- basketball_f |>
  ggplot(aes(x = total_exp_mill,
             y = total_rev_mill)) +
  geom_point() +
  labs(title = "Total Revenue vs. 
Total Expenditure",
       x = "Total expenditure 
(in million $)", y = "Total revenue (in million $)")

p_rev_type <- basketball_f |>
  ggplot(aes(x = sector_name,
             y = total_rev_mill)) +
  geom_boxplot() +
  coord_flip() +
  labs(title = "Total Revenue vs. 
Type of School",
       x = "Type of school", y = "Total revenue (in million $)")

p_rev_exp + p_rev_type

cor(basketball_f$total_exp_mill,
    basketball_f$total_rev_mill)
```
There is a positive, linear relationship between total expenditure and total revenue. The correlation between these two variables is 0.9641812, indicating a strong strength. There are more observations with total expenditure in the lower range, mostly concentrating between 0 and 20 million dollars. There are potential outliers where total expenditure is above 20 million dollars.

Public, 4 year or above and private nonprofit, 4-year or above have larger spreads and higher median of total revenue compared to the other types of school. The two types of school also have higher numbers of high values in total revenue, which are outliers exceeding the spread of most observations compared to the rest. Public, 4 year or above has the observation with the highest value of total revenue.

**A potential interaction effect between total number of student and type of school**
```{r, echo = FALSE, fig.width = 6, fig.height = 3}
basketball_f |>
  ggplot(aes(x = ef_total_count,
             y = total_rev_mill,
             color = sector_name)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  scale_color_discrete(name = "Type of school") +
  labs(title = "Total Revenue vs. Total Number of Student",
       x = "Total number of student", y = "Total revenue (in million $)")
```

The lines are not parallel indicating there is an interaction effect. The slope of total number of student differs based on the type of school.


## Analysis approach

Response variable: total_rev_menwomen, which is the total revenue in USD for men and women collegiate sports. 

Potential predictors: participation rate (sum_partic_men and sum_partic_women), type of school (sector_name), sport division (classification_name), expenditures (total_exp_menwomen), gender, and total count of students (ef_total_count).

We plan to use multiple linear regression as our regression model technique to analyze the relationship between the multiple potential predictors and the response variable. 


## Data dictionary

The data dictionary can be found [here](ADD%20LINK!!!) \[Update the link and remove this note!\]

Submit a data dictionary for all the variables in your data set in the `README` of the `data` folder. You do [not]{.underline} need to include the data dictionary in the PDF document.
